{"version":3,"sources":["index.js"],"names":["commander","colors","logMessage","execPromise","getConfig","commandConfig","defaultConfig","gitAddress","serviceFolderName","serviceStop","serviceStart","version","require","usage","option","on","white","green","parse","process","argv","args","firstCommander","isInit","cdServiceDirectory","config","result","error","red","createResult","startService","installResult","startResult","codeAct","isContinue","find","findValue","message"],"mappings":"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","sourcesContent":["#! /usr/bin/env node\nimport commander from 'commander';\nimport colors from 'colors';\nimport { logMessage, execPromise, getConfig } from './utils/process';\nimport { commandConfig } from './utils/command';\n// é…ç½®\nconst defaultConfig = {\n    // code-act-service gitåœ°å€\n    gitAddress: 'https://github.com/aisriver/code-act-service.git',\n    // æœåŠ¡æ–‡ä»¶å¤¹\n    serviceFolderName: 'code-act-service',\n    // æœåŠ¡ç»ˆæ­¢å‘½ä»¤\n    serviceStop: 'npm run stop',\n    // æœåŠ¡å¼€å§‹å‘½ä»¤\n    serviceStart: 'npm run start',\n};\ncommander\n    .version(require('../package.json').version)\n    .usage('[options] [project name]')\n    .option('-f, --find [value]', 'æŸ¥çœ‹serviceç›¸å…³é…ç½®ï¼ŒgitAddressï¼ˆæœåŠ¡ç«¯gitåœ°å€ï¼‰ã€serviceFolderNameï¼ˆæœåŠ¡æ–‡ä»¶å¤¹åç§°ï¼‰ã€serviceStopï¼ˆæœåŠ¡ç»ˆæ­¢å‘½ä»¤ï¼‰ã€serviceStartï¼ˆæœåŠ¡å¼€å§‹å‘½ä»¤ï¼‰')\n    //è‡ªå®šä¹‰å¸®åŠ©ä¿¡æ¯\n    .on('--help', () => {\n    logMessage('\\n\\nCommandsï¼š', colors.white, '');\n    logMessage('init        åˆå§‹åŒ–\\n', colors.green, '');\n})\n    .parse(process.argv);\nconst [firstCommander] = commander.args;\nconst isInit = firstCommander === 'init';\n/**\n * è¿›å…¥æœåŠ¡ç›®å½•\n */\nconst cdServiceDirectory = async (config) => {\n    const { gitAddress, serviceFolderName } = config;\n    logMessage(`å‡†å¤‡è¿›å…¥ ${serviceFolderName} æ–‡ä»¶å¤¹`);\n    const result = await execPromise(`cd ${serviceFolderName}`);\n    if (result.error) {\n        // å¦‚æœæ²¡æœ‰å°±åˆ›å»ºä¸€ä¸ª\n        logMessage(`æœªå‘ç° ${serviceFolderName} æ–‡ä»¶å¤¹ï¼Œå¼€å§‹åˆ›å»º`, colors.red);\n        const createResult = await execPromise(`git clone ${gitAddress} ${serviceFolderName}`);\n        if (createResult.error) {\n            logMessage(`åˆ›å»ºæœåŠ¡é‡åˆ°äº›é—®é¢˜ğŸ˜¨ï¼š${createResult.error}`, colors.red);\n            return;\n        }\n        logMessage(`åˆ›å»º ${serviceFolderName} æˆåŠŸ!ğŸ˜€`, colors.green);\n        cdServiceDirectory(config);\n        return;\n    }\n    logMessage(`è¿›å…¥ ${serviceFolderName} æˆåŠŸ!ğŸ˜ƒ`, colors.green);\n    startService(config);\n};\n/**\n * å¯åŠ¨é¡¹ç›®\n */\nconst startService = async (config) => {\n    const { serviceFolderName, serviceStop, serviceStart } = config;\n    logMessage(`æ›´æ–°/å®‰è£…ä¾èµ–ï¼Œè¯·è€å¿ƒç­‰å¾…${isInit ? 'ï¼ˆå½“å‰ä¸ºåˆå§‹åŒ–çŠ¶æ€ï¼Œæ—¶é—´å¯èƒ½ä¼šé•¿ä¸€äº›ğŸ˜Šï¼‰' : 'ğŸ˜‰'}...`);\n    const installResult = await execPromise(`cd ${serviceFolderName} && git stash && git pull && npm install`);\n    if (installResult.error) {\n        logMessage(`æ›´æ–°/å®‰è£…ä¾èµ–é‡åˆ°äº›é—®é¢˜ğŸ˜­ï¼š${installResult.error}`, colors.red);\n        return;\n    }\n    logMessage(`ä¾èµ–å®‰è£…æˆåŠŸï¼ğŸ˜†`, colors.green);\n    logMessage(`å¼€å§‹å¯åŠ¨ğŸ˜‡...`);\n    await execPromise(`cd ${serviceFolderName} && ${serviceStop}`);\n    const startResult = await execPromise(`cd ${serviceFolderName} && ${serviceStart}`);\n    if (startResult.error) {\n        logMessage(`æœåŠ¡å¯åŠ¨é‡åˆ°äº›é—®é¢˜ğŸ˜£ï¼š${startResult.error}`, colors.red);\n        return;\n    }\n    logMessage(`å¯åŠ¨æˆåŠŸï¼OPEN: http://localhost:7001`, colors.green);\n};\n/**\n * æ‰§è¡Œ\n */\nconst codeAct = async () => {\n    // è¯»å–/å†™å…¥é…ç½®æ–‡ä»¶\n    const result = await getConfig(defaultConfig);\n    if (!result.isContinue) {\n        return;\n    }\n    const config = result.config;\n    // é…ç½®æŸ¥è¯¢\n    if (commander.find) {\n        const findValue = config[commander.find];\n        if (findValue) {\n            logMessage(findValue, colors.green, '');\n        }\n        else {\n            let message = `${commander.find}ä¸åœ¨æŸ¥è¯¢èŒƒå›´`;\n            if (typeof commander.find === 'boolean') {\n                message = 'è¯·è¾“å…¥æŸ¥è¯¢å‚æ•°';\n            }\n            logMessage(`${message}ï¼Œå¯æŸ¥è¯¢å‚æ•°ï¼ˆgitAddress | serviceFolderName | serviceStop | serviceStartï¼‰`, colors.red, '');\n        }\n        return;\n    }\n    // åˆå§‹åŒ–é¡¹ç›®\n    if (isInit) {\n        // åˆå§‹åŒ–çŠ¶æ€å…ˆåˆ é™¤å¯¹åº”çš„æ–‡ä»¶å¤¹\n        logMessage(`åˆå§‹åŒ–...`);\n        await execPromise(`${commandConfig.delete} ${config.serviceFolderName}`);\n    }\n    cdServiceDirectory(config);\n};\ncodeAct();\n"],"file":"index.js"}